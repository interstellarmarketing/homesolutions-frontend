---
import NavMain from "@components/nav/NavMain.astro";
import Posthog from "@components/anaytics/Posthog.astro";
import TrustedForm from '@components/TrustedForm.astro';

/**
 * Props interface for the Layout component
 * @property {string} [title] - Optional page title
 * @property {string} [description] - Optional page description
 */
interface Props {
	title?: string;
	description?: string;
}

/**
 * Default SEO metadata configuration
 */
const DEFAULT_SEO = {
	title: "contracting estimates",
	description: "Get accurate contracting estimates for your project",
	siteName: "Contracting Estimates",
	canonical: Astro.url.href,
};

/**
 * Formats the page title with consistent branding
 * @param {string | undefined} title - The page-specific title
 * @returns {string} The formatted title
 */
const formatTitle = (title?: string): string => {
	return title ? `estimates - ${title}` : DEFAULT_SEO.title;
};

// Destructure props with default values
const { 
	title,
	description = DEFAULT_SEO.description 
} = Astro.props;

// Environment-based configuration
const isLocal = Astro?.url?.host?.startsWith("localhost");
const formattedTitle = formatTitle(title);
---

<!doctype html>
<html lang="en" class="h-full">
	<head>
		<!-- Character encoding -->
		<meta charset="UTF-8" />
		
		<!-- Primary Meta Tags -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content={description} />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Favicon -->
		<link 
			rel="icon" 
			type="image/svg+xml" 
			href="/favicon.svg"
		/>
		
		<!-- Open Graph / Social Media Meta Tags -->
		<meta property="og:type" content="website" />
		<meta property="og:title" content={formattedTitle} />
		<meta property="og:description" content={description} />
		<meta property="og:url" content={Astro.url.href} />
		
		<!-- Analytics Integration -->
		{!isLocal && <Posthog />}
		
		<!-- Page Title -->
		<title>{formattedTitle}</title>
		<TrustedForm />
	</head>
	<body class="text-white bg-slate-950 min-h-dvh flex flex-col">
		<NavMain />
		<main class="flex flex-col grow h-full items-center">
			<slot />
		</main>
	</body>
</html>
