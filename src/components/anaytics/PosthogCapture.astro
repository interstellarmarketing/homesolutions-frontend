<script>
  import posthog from "posthog-js";
  import { estimateStore } from "@stores/estimateProgress";
  import { crossPlatformLoader } from "@utils/crossPlatformLoader";
  // Wait for PostHog to initialize
  crossPlatformLoader(() => {
    // Get the current PostHog person ID
    const personId = posthog.get_distinct_id();

    // Update the estimate store directly
    const existingStore = estimateStore.get();
    const existingTrackingParams = existingStore.trackingParams || {};

    estimateStore.set({
      ...existingStore,
      trackingParams: {
        ...existingTrackingParams,
        posthogPersonId: personId,
      },
    });
  });
</script>
