<script>
  import posthog from "posthog-js";
  import { estimateStore } from "@stores/estimateProgress";

  // Function to update PostHog person ID in the store
  function updatePosthogPersonId() {
    // Get the current PostHog person ID
    const personId = posthog.get_distinct_id();

    // Update the estimate store with the PostHog person ID
    const currentStore = estimateStore.get();
    estimateStore.set({
      ...currentStore,
      posthogPersonId: personId,
    });
  }

  // Listen for both initial page load and client-side navigation
  document.addEventListener("DOMContentLoaded", updatePosthogPersonId);
  document.addEventListener("astro:page-load", updatePosthogPersonId);
</script>

